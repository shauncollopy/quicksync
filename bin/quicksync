#!/usr/bin/env ruby

require 'quicksync'

if ARGV.size < 0
  puts "Usage: quicksync <from> <to>"
  exit
end

puts "argv=#{ARGV}"
if ARGV[0].nil?
	from = "/qs/test/from_args/from"
else
	from = ARGV[0]
end

if ARGV[1].nil?
	to = "/qs/test/from_args/from"
else
	to  = ARGV[1]
end

puts "after parsing ARGS, from=#{from}, to=#{to}"

if from.include?("@")
	user_and_host = from.split(":").first
	dir = from.split(":").last
	user = user_and_host.split("@").first
	host = user_and_host.split("@").last
	from = { :dir=>dir, :host=>host, :user=>user}
else
	from = { :dir=>from }
end
	
if to.include?("@")
	user_and_host = to.split(":").first
	dir = to.split(":").last
	user = user_and_host.split("@").first
	host = user_and_host.split("@").last
	to = { :dir=>dir, :host=>host, :user=>user}
else
	to = { :dir=>to }
end

r  = QuickSync::RSync.new.pull_from(from,to)
